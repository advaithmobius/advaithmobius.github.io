<html>
  <title>Priority Matrix</title>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
       google.charts.load('current', {'packages':['corechart', 'controls']});

      // Set a callback to run when the Google Visualization API is loaded.
      google.charts.setOnLoadCallback(initialize);

      function initialize() {
        var query = new google.visualization.Query(
            'https://docs.google.com/spreadsheets/d/1zSx0034nGvjlZSufEE9-B_pavuwmeJufi1r7n98mfkk/gviz/tq?gid=1248477434&headers=1&range=A1:L1000');
        query.send(draw);
      }

      function draw(response) {
        if (response.isError()) {
          alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
          return;
        }

        var control = new google.visualization.ControlWrapper({
          controlType: 'CategoryFilter',
          containerId: 'control_div',
          options: {
            filterColumnLabel: 'Type'
          }
        });
  
        var data = response.getDataTable();
        var chart = new google.visualization.ChartWrapper({   
          chartType: 'BubbleChart',
          containerId: 'chart_div',
          options: {
            title: 'Priority Matrix',
            width: 1000,
            height: 750,
            hAxis: {
              title: 'Urgency',
              format: 'long',
              viewWindowMode:'explicit',
              viewWindow:{
                    max:12,
                    min:0
                  },
              ticks: [5,10]
            },
            vAxis: {
              title: 'Importance',
              viewWindowMode:'explicit',
              viewWindow:{
                    max:12,
                    min:0
                  },
              ticks: [5,10]
            },
            bubble: {
              textStyle: {
                fontSize: 9,
                auraColor: 'none'
              }
            }
            }
          });
        var dashboard = new google.visualization.Dashboard(document.getElementById('dashboard'));
        dashboard.bind(control,chart);
        dashboard.draw(data);    
      }
    </script>
  </head>

  <body>
    <table align="center">
      <tr>
        <td colSpan=1>
          <div id="dashboard">
            <div id="control_div"></div>
            <div id="chart_div"></div>
          </div>
        </td>
      </tr>
    </table>
      
  </body>
</html>
